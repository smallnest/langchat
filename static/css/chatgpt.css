@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;700&display=swap');

:root {
    --sidebar-width: 260px;
    --sidebar-bg: #171717;
    /* Darker, more premium charcoal */
    --text-primary: #ECECEC;
    --text-secondary: #A1A1AA;
    /* Zing-400 equivalent */
    --main-bg: #212121;
    /* Slightly lighter than sidebar */
    --message-user-bg: transparent;
    --message-assistant-bg: transparent;
    /* Cleaner look */
    --input-bg: #2F2F2F;
    --border-color: #424242;
    /* Subtle borders */
    --accent-color: #10a37f;
    --accent-hover: #1a7f64;
    --placeholder-color: #8e8ea0;
    --glass-bg: rgba(32, 33, 35, 0.7);
    --glass-border: rgba(255, 255, 255, 0.1);
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --font-primary: 'Inter', system-ui, -apple-system, sans-serif;
    --font-mono: 'JetBrains Mono', monospace;
    --branding-logo-bg: #fff;
    --branding-logo-color: #000;
}

[data-theme="light"] {
    --sidebar-bg: #F9F9F9;
    --text-primary: #111827;
    --text-secondary: #6B7280;
    --main-bg: #FFFFFF;
    --message-user-bg: transparent;
    --message-assistant-bg: transparent;
    --input-bg: #F3F4F6;
    --border-color: #E5E7EB;
    --accent-color: #10a37f;
    --placeholder-color: #9CA3AF;
    --glass-bg: rgba(255, 255, 255, 0.8);
    --glass-border: rgba(0, 0, 0, 0.05);
    --branding-logo-bg: #000;
    --branding-logo-color: #fff;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: var(--font-primary);
    background-color: var(--main-bg);
    color: var(--text-primary);
    height: 100vh;
    display: flex;
    overflow: hidden;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: rgba(150, 150, 150, 0.3);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(150, 150, 150, 0.5);
}

/* Sidebar */
.sidebar {
    width: var(--sidebar-width);
    background-color: var(--sidebar-bg);
    display: flex;
    flex-direction: column;
    padding: 0.75rem;
    color: var(--text-primary);
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border-right: 1px solid var(--border-color);
    position: relative;
    z-index: 20;
}

.new-chat-btn {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
    color: var(--text-primary);
    background: transparent;
    font-size: 0.9rem;
    font-weight: 500;
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow-sm);
}

.new-chat-btn:hover {
    background-color: var(--border-color);
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
}

.new-chat-btn svg {
    width: 1.25rem;
    height: 1.25rem;
}

.history-list {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding-right: 4px;
    /* Space for scrollbar */
}

.history-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 0.5rem;
    border-radius: 0.5rem;
    cursor: pointer;
    color: var(--text-secondary);
    font-size: 0.9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: all 0.2s ease;
    border: 1px solid transparent;
}

.history-item svg {
    flex-shrink: 0;
    opacity: 0.7;
}

.history-item:hover {
    background-color: rgba(255, 255, 255, 0.03);
    color: var(--text-primary);
}

[data-theme="light"] .history-item:hover {
    background-color: rgba(0, 0, 0, 0.03);
}

.history-item.active {
    background-color: rgba(255, 255, 255, 0.08);
    color: var(--text-primary);
    border-color: rgba(255, 255, 255, 0.05);
}

[data-theme="light"] .history-item.active {
    background-color: #E5E7EB;
    color: #111827;
    border-color: #D1D5DB;
}

.sidebar-footer {
    border-top: 1px solid var(--border-color);
    padding-top: 1rem;
    margin-top: auto;
}

.user-profile {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    cursor: pointer;
    border-radius: 0.5rem;
    transition: background-color 0.2s;
}

.user-profile:hover {
    background-color: rgba(255, 255, 255, 0.05);
}

[data-theme="light"] .user-profile:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

/* Main Chat Area */
.main-chat {
    flex: 1;
    display: flex;
    flex-direction: column;
    height: 100vh;
    position: relative;
    background-color: var(--main-bg);
}

.model-selector {
    height: 4rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 1.1rem;
    backdrop-filter: blur(8px);
    position: absolute;
    top: 0;
    width: 100%;
    z-index: 10;
    /* Optional: glass border at bottom */
    /* border-bottom: 1px solid var(--glass-border); */
}

.messages {
    flex: 1;
    overflow-y: auto;
    width: 100%;
    scroll-behavior: smooth;
    padding-top: 5rem;
    /* Space for model selector */
    padding-bottom: 12rem;
    /* Space for input area */
}

/* Messages Animation */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.message {
    padding: 1.5rem 0;
    display: flex;
    justify-content: center;
    border-bottom: 1px solid transparent;
    /* Cleaner, no separator lines */
    animation: fadeIn 0.3s ease-out forwards;
}

/* Highlight user messages slightly only if needed, but often clean is better. 
   Let's keep them same bg but distinct layout/avatar. */
/* 
.message.user {} 
.message.assistant {} 
*/

.message-content-wrapper {
    display: flex;
    gap: 1.5rem;
    width: 100%;
    max-width: 48rem;
    padding: 0 1.5rem;
}

/* Avatars */
.avatar {
    width: 36px;
    height: 36px;
    border-radius: 0.375rem;
    /* Slightly rounded square */
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-weight: 600;
    font-size: 0.9rem;
    box-shadow: var(--shadow-sm);
}

/* Message Text */
.message-text {
    flex: 1;
    line-height: 1.75;
    font-size: 1rem;
    overflow-wrap: break-word;
    margin-top: 0.35rem;
    /* Align with avatar center visually */
    color: var(--text-primary);
}

/* Markdown Styles */
.message-text p {
    margin-bottom: 1rem;
}

.message-text p:last-child {
    margin-bottom: 0;
}

.message-text h1,
.message-text h2,
.message-text h3 {
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    font-weight: 600;
    line-height: 1.3;
}

.message-text ul,
.message-text ol {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
}

.message-text li {
    margin-bottom: 0.25rem;
}

.message-text code {
    font-family: var(--font-mono);
    font-size: 0.9em;
    background-color: rgba(127, 127, 127, 0.15);
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
}

.message-text pre {
    background-color: #0d0d0d !important;
    /* Force dark background for code blocks */
    border-radius: 0.5rem;
    padding: 1rem;
    overflow-x: auto;
    margin: 1rem 0;
    border: 1px solid #333;
}

[data-theme="light"] .message-text pre {
    background-color: #f6f8fa !important;
    border: 1px solid #e5e7eb;
}

.message-text pre code {
    background-color: transparent;
    padding: 0;
    border-radius: 0;
    color: inherit;
    font-size: 0.875rem;
}

/* Input Area */
.input-area {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background-image: linear-gradient(180deg, rgba(33, 33, 33, 0), var(--main-bg) 20%);
    padding: 0 1rem 3rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 20;
}

[data-theme="light"] .input-area {
    background-image: linear-gradient(180deg, rgba(255, 255, 255, 0), var(--main-bg) 20%);
}

.input-container {
    width: 100%;
    max-width: 48rem;
    position: relative;
    background-color: var(--input-bg);
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-md);
    border-radius: 1rem;
    /* More rounded */
    display: flex;
    flex-direction: column;
    transition: border-color 0.2s, box-shadow 0.2s;
}

.input-container:focus-within {
    border-color: rgba(127, 127, 127, 0.4);
    box-shadow: 0 0 0 2px rgba(127, 127, 127, 0.1);
}

.input-box {
    width: 100%;
    max-height: 200px;
    padding: 1rem 3.5rem 1rem 1.25rem;
    border: none;
    background: transparent;
    color: var(--text-primary);
    font-family: var(--font-primary);
    font-size: 1rem;
    resize: none;
    outline: none;
    line-height: 1.5;
}

.send-btn {
    position: absolute;
    bottom: 0.75rem;
    right: 0.75rem;
    background: var(--accent-color);
    border: none;
    color: white;
    cursor: pointer;
    padding: 0.35rem;
    border-radius: 0.5rem;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.send-btn:hover {
    background-color: var(--accent-hover);
    transform: scale(1.05);
}

.send-btn.disabled {
    background-color: transparent;
    color: var(--text-secondary);
    cursor: default;
    transform: none;
}

/* Typing Indicator */
.typing {
    display: inline-block;
    width: 24px;
    height: 8px;
    position: relative;
}

.typing::after {
    content: '...';
    position: absolute;
    top: -8px;
    font-weight: bold;
    font-size: 1.25rem;
    letter-spacing: 2px;
    animation: typing 1.5s infinite steps(4);
}

@keyframes typing {

    0%,
    100% {
        clip-path: inset(0 100% 0 0);
    }

    50% {
        clip-path: inset(0 0 0 0);
    }
}

/* Welcome Screen */
.welcome-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    gap: 2.5rem;
    color: var(--text-primary);
    padding-bottom: 5rem;
}

.welcome-logo {
    width: 80px;
    height: 80px;
    margin-bottom: 1rem;
    animation: float 6s ease-in-out infinite;
}

@keyframes float {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-10px);
    }
}

.examples-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    max-width: 48rem;
    width: 100%;
    padding: 0 1rem;
}

.example-column {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.example-card {
    background-color: var(--input-bg);
    padding: 1rem 1.25rem;
    border-radius: 0.75rem;
    width: 100%;
    cursor: pointer;
    font-size: 0.95rem;
    color: var(--text-secondary);
    border: 1px solid transparent;
    transition: all 0.2s;
    text-align: left;
    position: relative;
    overflow: hidden;
}

.example-card:hover {
    background-color: rgba(127, 127, 127, 0.1);
    color: var(--text-primary);
    border-color: var(--border-color);
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    .sidebar {
        position: fixed;
        left: -100%;
        height: 100%;
        width: 80%;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
    }

    .sidebar.open {
        left: 0;
    }

    .examples-grid {
        grid-template-columns: 1fr;
    }

    .message-content-wrapper {
        padding: 0 1rem;
    }
}

/* Delete button styling */
.delete-btn {
    background: transparent;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    opacity: 0;
    transition: opacity 0.2s, background-color 0.2s, color 0.2s;
    margin-left: 0.5rem;
    flex-shrink: 0;
}

.history-item:hover .delete-btn,
.history-item.active .delete-btn {
    opacity: 1;
}

.delete-btn:hover {
    background-color: rgba(255, 0, 0, 0.2);
    color: #ff6b6b;
}

[data-theme="light"] .delete-btn:hover {
    background-color: rgba(255, 0, 0, 0.1);
    color: #ef4444;
}

/* Ensure history item content aligns properly */
.history-item {
    justify-content: space-between;
    /* Push delete button to right */
    align-items: center;
    /* Center vertically */
}

/* Sidebar Toggle */
.sidebar-toggle {
    background: transparent;
    border: none;
    cursor: pointer;
    color: var(--text-secondary);
    border-radius: 0.375rem;
    padding: 0.25rem;
    transition: background-color 0.2s, color 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.sidebar-toggle:hover {
    background-color: var(--border-color);
    color: var(--text-primary);
}

.mobile-header {
    display: none;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--border-color);
    background-color: var(--sidebar-bg);
}

.mobile-branding {
    font-weight: 600;
    color: var(--text-primary);
}

/* Collapsed Sidebar */
.sidebar.collapsed {
    width: 0;
    padding: 0;
    overflow: hidden;
    border-right: none;
}

.fixed-toggle {
    background-color: transparent;
    color: var(--text-secondary);
}

.fixed-toggle:hover {
    background-color: rgba(0, 0, 0, 0.1);
}

[data-theme="dark"] .fixed-toggle:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

@media (max-width: 768px) {
    .mobile-header {
        display: flex;
    }

    .model-selector {
        display: none;
        /* Hide standard header on mobile */
    }
}

/* Message Actions */
.message-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0;
}

.message-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
    opacity: 1;
}

.action-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    color: var(--text-secondary);
    padding: 0.25rem;
    border-radius: 0.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s, color 0.2s;
}

.action-btn:hover {
    background-color: var(--border-color);
    color: var(--text-primary);
}

.action-btn svg {
    width: 1rem;
    height: 1rem;
}

/* Feedback active states */
.action-btn.active {
    color: var(--accent-color);
}

/* Rail-style collapsed sidebar */
.sidebar.collapsed {
    width: 60px;
    padding: 0.75rem 0.5rem;
    overflow: visible;
    /* To allow tooltips if we added them, but overflow-x hidden for content */
}

.sidebar.collapsed .logo-text,
.sidebar.collapsed .btn-text,
.sidebar.collapsed .user-text,
.sidebar.collapsed .history-list {
    display: none;
}

.sidebar.collapsed .sidebar-header {
    justify-content: center;
    padding: 0;
    gap: 0;
    flex-direction: column-reverse;
    /* Put toggle button at top or replace logo? */
    /* Wait, the image shows logo at top. Toggle button is not clearly visible in closed rail?
       Or the logo IS the toggle? 
       Let's stack them or hide the toggle and make Logo clickable?
       Actually, standard pattern: Keep Header. Hide Text.
       Header becomes: [Logo] [Toggle]. Flex row.
       In collapsed: 60px width.
       [Logo]
       [Toggle] <- wrapped?
       Let's just center items.
    */
    flex-direction: column;
    align-items: center;
    margin-bottom: 1rem;
}

.sidebar.collapsed #sidebar-app-name {
    display: none;
}

/* Hide the logo image container in collapsed if we want only toggle? 
   No, user image shows logo. 
   User image shows: Logo, then New Chat.
   Where is toggle? Maybe toggle is on hover or somewhere else?
   Let's keep Sidebar Header items centered.
*/

.sidebar.collapsed .sidebar-header>* {
    margin: 0;
}

.sidebar.collapsed .sidebar-toggle {
    display: flex;
    /* Keep visible to expand */
    margin-top: 0.5rem;
}

.sidebar.collapsed .new-chat-btn {
    padding: 0.75rem;
    justify-content: center;
}

.sidebar.collapsed .new-chat-btn svg {
    margin: 0;
}

.sidebar.collapsed .user-profile {
    justify-content: center;
    padding: 0.75rem 0;
}

.sidebar.collapsed .avatar {
    margin: 0;
}

/* Theme Menu */
.theme-menu {
    position: absolute;
    bottom: 100%;
    left: 0.75rem;
    width: calc(100% - 1.5rem);
    background-color: var(--sidebar-bg);
    /* Match sidebar or lighter? */
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 0.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    box-shadow: var(--shadow-md);
    z-index: 50;
    margin-bottom: 0.5rem;
    /* Determine background based on theme for contrast */
    background-color: var(--main-bg);
}

.theme-menu.hidden {
    display: none;
}

.theme-option {
    padding: 0.5rem;
    border-radius: 0.25rem;
    cursor: pointer;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-primary);
}

.theme-option:hover {
    background-color: var(--border-color);
}

/* Theme Icon Btn in Footer */
.theme-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    color: var(--text-secondary);
    padding: 0.5rem;
    border-radius: 0.25rem;
    margin-left: auto;
    /* Push to right */
    display: flex;
    align-items: center;
    justify-content: center;
}

.theme-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: var(--text-primary);
}

[data-theme="light"] .theme-btn:hover {
    background-color: rgba(0, 0, 0, 0.1);
}

/* Fancy Theme */
[data-theme="fancy"] {
    --sidebar-bg: #2d1b4e;
    --text-primary: #ffffff;
    --text-secondary: #d4bbff;
    --main-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    --message-user-bg: rgba(255, 255, 255, 0.1);
    --message-assistant-bg: transparent;
    --input-bg: rgba(255, 255, 255, 0.1);
    --border-color: rgba(255, 255, 255, 0.1);
    --accent-color: #ff007a;
    --placeholder-color: #a0a0c0;
    --glass-bg: rgba(45, 27, 78, 0.7);
    --glass-border: rgba(255, 255, 255, 0.2);
    --branding-logo-bg: #ff007a;
    --branding-logo-color: #fff;
}

/* Stacked footer items in collapsed mode */
.sidebar.collapsed .user-profile {
    flex-direction: column-reverse;
    /* Theme button top, Avatar bottom */
    gap: 0.75rem;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    height: auto;
}

.sidebar.collapsed .theme-btn {
    margin: 0;
    /* Remove auto left margin */
    padding: 0.5rem;
    width: 100%;
    /* Center in container */
}

/* Adjust Theme Menu in collapsed mode */
.sidebar.collapsed .theme-menu {
    position: fixed;
    left: 70px;
    bottom: 100px;
    width: 150px;
    margin-left: 0;
    z-index: 1000;
}

/* Tools Status Indicators */
.tools-status {
    display: flex;
    gap: 1rem;
    align-items: center;
    margin-left: auto;
}

.skills-status,
.mcp-status {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.4rem 0.75rem;
    border-radius: 0.5rem;
    background-color: var(--border-color);
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s;
}

.skills-status:hover,
.mcp-status:hover {
    background-color: var(--input-bg);
}

.skills-indicator,
.mcp-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: #6c757d;
    transition: background-color 0.3s;
}

.skills-indicator.enabled,
.mcp-indicator.enabled {
    background-color: var(--accent-color);
    box-shadow: 0 0 8px var(--accent-color);
}

.skills-indicator.disabled,
.mcp-indicator.disabled {
    background-color: #6c757d;
}

.skills-text,
.mcp-text {
    font-weight: 500;
    color: var(--text-primary);
}

/* Mobile header adjustments for tools status */
.mobile-header .tools-status {
    gap: 0.5rem;
}

.mobile-header .skills-status,
.mobile-header .mcp-status {
    padding: 0.3rem 0.6rem;
    font-size: 0.75rem;
}

/* Desktop Header */
.desktop-header {
    display: none;
    height: 60px;
    padding: 0 1.5rem;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border-color);
    background-color: var(--main-bg);
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(10px);
}

.desktop-header .header-title {
    font-weight: 600;
    font-size: 1.1rem;
    color: var(--text-primary);
}

@media (min-width: 769px) {
    .desktop-header {
        display: flex;
    }

    .mobile-header {
        display: none;
    }

    .messages {
        padding-top: 0;
        /* Header handles height now */
    }
}

/* Logout Button */
.logout-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    background: transparent;
    border: 1px solid var(--border-color);
    border-radius: 0.375rem;
    cursor: pointer;
    color: var(--text-secondary);
    transition: all 0.2s ease;
    margin-left: 0.75rem;
}

.logout-btn:hover {
    background-color: var(--border-color);
    color: var(--text-primary);
    transform: translateY(-1px);
}

.logout-btn svg {
    width: 18px;
    height: 18px;
}